{"ast":null,"code":"import _objectSpread from\"C:/Users/ampri/OneDrive/Documents/HseMaps/HseMaps/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from\"react\";import{useMsal}from\"@azure/msal-react\";import{loginRequest}from\"../src/Auth/authConfig\";import{useState}from'react';import axios from'axios';import{useEffect}from\"react\";import Navbar from\"../src/Components/Navbar\";import AuthContext from\"../src/Auth/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[auth,setAuth]=useState({isAuth:false});const{instance,accounts}=useMsal();useEffect(()=>{if(accounts[0]){instance.acquireTokenSilent(_objectSpread(_objectSpread({},loginRequest),{},{account:accounts[0]})).then(response=>{const resp=_objectSpread(_objectSpread({},response.account),{},{grade:parseInt(response.account.grade)});setAuth(prev=>_objectSpread(_objectSpread({},prev),{},{token:response.accessToken,user:resp}));testToken(response.accessToken);});}},[accounts]);const testToken=async token=>{const res=await axios.get(\"https://graph.microsoft.com/v1.0/me\",{headers:{Authorization:\"Bearer \".concat(token)}});if(res.data.jobTitle===\"12\"||res.data.jobTitle===\"11\"||res.data.jobTitle===\"10\"||res.data.jobTitle===\"9\"){setAuth(prev=>_objectSpread(_objectSpread({},prev),{},{isAuth:true,user:_objectSpread(_objectSpread({},prev.user),{},{role:\"student\",displayName:\"\".concat(res.data.givenName,\" \").concat(res.data.surname),grade:res.data.jobTitle})}));}};console.log(auth);return/*#__PURE__*/_jsxs(AuthContext.Provider,{value:{auth,setAuth},children:[/*#__PURE__*/_jsx(Navbar,{instance:instance,loginRequest:loginRequest}),/*#__PURE__*/_jsx(\"h1\",{children:\"HSE AD Boilerplate\"}),auth.isAuth?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:auth.user.role}),/*#__PURE__*/_jsx(\"h2\",{children:\"Name:\"+auth.user.displayName}),/*#__PURE__*/_jsx(\"h2\",{children:\"Grade: \"+auth.user.grade}),/*#__PURE__*/_jsx(\"h2\",{children:\"Email: \"+auth.user.username})]}):/*#__PURE__*/_jsx(\"div\",{})]});}export default App;","map":{"version":3,"names":["React","useMsal","loginRequest","useState","axios","useEffect","Navbar","AuthContext","jsx","_jsx","jsxs","_jsxs","App","auth","setAuth","isAuth","instance","accounts","acquireTokenSilent","_objectSpread","account","then","response","resp","grade","parseInt","prev","token","accessToken","user","testToken","res","get","headers","Authorization","concat","data","jobTitle","role","displayName","givenName","surname","console","log","Provider","value","children","username"],"sources":["C:/Users/ampri/OneDrive/Documents/HseMaps/HseMaps/src/App.js"],"sourcesContent":["import React from \"react\";\r\nimport { useMsal } from \"@azure/msal-react\";\r\nimport { loginRequest } from \"../src/Auth/authConfig\";\r\nimport {useState} from 'react';\r\nimport axios from 'axios';\r\nimport { useEffect } from \"react\";\r\nimport Navbar from \"../src/Components/Navbar\";\r\nimport AuthContext from \"../src/Auth/AuthContext\";\r\n\r\nfunction App() {\r\n  const [auth, setAuth] = useState({\r\n    isAuth: false,\r\n  });\r\n  const { instance, accounts } = useMsal();\r\n\r\n\r\n      useEffect(() => {\r\n        if (accounts[0]) {\r\n          instance\r\n            .acquireTokenSilent({\r\n              ...loginRequest,\r\n              account: accounts[0],\r\n            })\r\n            .then((response) => {\r\n              const resp = {...response.account, grade: parseInt(response.account.grade)}\r\n              setAuth((prev) => ({\r\n                ...prev,\r\n                token: response.accessToken,\r\n                user: resp,\r\n              }));\r\n    \r\n              testToken(response.accessToken);\r\n            });\r\n        }\r\n      }, [accounts]);\r\n\r\n     \r\n      const testToken = async (token) => {\r\n        const res = await axios.get(\"https://graph.microsoft.com/v1.0/me\", {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        });\r\n    \r\n        if (\r\n          res.data.jobTitle === \"12\" ||\r\n          res.data.jobTitle === \"11\" ||\r\n          res.data.jobTitle ===\"10\" ||\r\n          res.data.jobTitle === \"9\"\r\n        ) {\r\n          setAuth((prev) => ({\r\n            ...prev,\r\n            isAuth: true,\r\n            user: {\r\n              ...prev.user,\r\n              role: \"student\",\r\n              displayName: `${res.data.givenName} ${res.data.surname}`,\r\n              grade: res.data.jobTitle,\r\n            },\r\n          }));\r\n        }\r\n      };\r\n\r\nconsole.log(auth)\r\n  return (\r\n    \r\n    <AuthContext.Provider value={{ auth, setAuth }}>\r\n        <Navbar instance={instance} \r\n        loginRequest={loginRequest} />\r\n      \r\n        <h1>HSE AD Boilerplate</h1>\r\n      {auth.isAuth ? \r\n                <div>\r\n                 \r\n                  <h1>{auth.user.role}</h1>\r\n                  <h2>{\"Name:\" + auth.user.displayName}</h2>\r\n                  <h2>{\"Grade: \" + auth.user.grade}</h2>\r\n                  <h2>{\"Email: \" + auth.user.username}</h2>\r\n                </div>  :\r\n\r\n                <div>\r\n                \r\n                </div>\r\n          }\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}